y <- X %*% c(1, 2, 2, 3, 4, 0, 0, 0)
lassos=cv.glmnet(X, y, alpha=1, lambda = exp(seq(-10, 5, 0.1)))
ridges=cv.glmnet(X, y, alpha=0, lambda = exp(seq(-10, 5, 0.1)))
plot(lassos, ylab = "", yaxt="n")
par(new=TRUE)
plot(ridges, ylab="", yaxt="n")
n <- 500
Sigma <- matrix(runif(64, 0, 0.5), nrow = 8, ncol = 8)
diag(Sigma) <- 1
Sigma[lower.tri(Sigma)] = t(Sigma)[lower.tri(Sigma)]
X <- mvrnorm(n = n, c(1:5, 0, 0, 0), Sigma)
y <- X %*% c(1, 2, 2, 3, 4, 0, 0, 0)
lassos=cv.glmnet(X, y, alpha=1, lambda = exp(seq(-10, 5, 0.1)))
ridges=cv.glmnet(X, y, alpha=0, lambda = exp(seq(-10, 5, 0.1)))
plot(lassos, ylab = "", yaxt="n")
par(new=TRUE)
plot(ridges, ylab="", yaxt="n")
n <- 500
Sigma <- matrix(runif(64, 0, 0.5), nrow = 8, ncol = 8)
diag(Sigma) <- 1
Sigma[lower.tri(Sigma)] = t(Sigma)[lower.tri(Sigma)]
X <- mvrnorm(n = n, c(1:5, 0, 0, 0), Sigma)
y <- X %*% c(1, 2, 2, 3, 4, 0, 0, 0)
lassos=cv.glmnet(X, y, alpha=1, lambda = exp(seq(-10, 5, 0.3)))
ridges=cv.glmnet(X, y, alpha=0, lambda = exp(seq(-10, 5, 0.3)))
plot(lassos, ylab = "", yaxt="n")
par(new=TRUE)
plot(ridges, ylab="", yaxt="n")
n <- 500
Sigma <- matrix(runif(64, 0, 0.5), nrow = 8, ncol = 8)
diag(Sigma) <- 1
Sigma[lower.tri(Sigma)] = t(Sigma)[lower.tri(Sigma)]
X <- mvrnorm(n = n, c(1:5, 0, 0, 0), Sigma)
y <- X %*% c(1, 2, 2, 3, 4, 0, 0, 0)
lassos=cv.glmnet(X, y, alpha=1, lambda = exp(seq(-10, 5, 0.3)))
ridges=cv.glmnet(X, y, alpha=0, lambda = exp(seq(-10, 5, 0.3)))
plot(lassos, ylab = "MSE", yaxt="n")
par(new=TRUE)
plot(ridges, ylab="", yaxt="n")
n <- 500
Sigma <- matrix(runif(64, 0, 0.5), nrow = 8, ncol = 8)
diag(Sigma) <- 1
Sigma[lower.tri(Sigma)] = t(Sigma)[lower.tri(Sigma)]
X <- mvrnorm(n = n, c(1:5, 0, 0, 0), Sigma)
y <- X %*% c(1, 2, 2, 3, 4, 0, 0, 0)
lassos=cv.glmnet(X, y, alpha=1, lambda = exp(seq(-5, 5, 0.3)))
ridges=cv.glmnet(X, y, alpha=0, lambda = exp(seq(-5, 5, 0.3)))
plot(lassos, ylab = "MSE", yaxt="n")
par(new=TRUE)
plot(ridges, ylab="", yaxt="n")
n <- 500
Sigma <- matrix(runif(64, 0, 0.5), nrow = 8, ncol = 8)
diag(Sigma) <- 1
Sigma[lower.tri(Sigma)] = t(Sigma)[lower.tri(Sigma)]
X <- mvrnorm(n = n, c(1:5, 0, 0, 0), Sigma)
y <- X %*% c(1, 2, 2, 3, 4, 0, 0, 0)
lassos=cv.glmnet(X, y, alpha=1, lambda = exp(seq(-2, 5, 0.3)))
ridges=cv.glmnet(X, y, alpha=0, lambda = exp(seq(-2, 5, 0.3)))
plot(lassos, ylab = "MSE", yaxt="n")
par(new=TRUE)
plot(ridges, ylab="", yaxt="n")
n <- 500
Sigma <- matrix(runif(64, 0, 0.5), nrow = 8, ncol = 8)
diag(Sigma) <- 1
Sigma[lower.tri(Sigma)] = t(Sigma)[lower.tri(Sigma)]
X <- mvrnorm(n = n, c(1:5, 0, 0, 0), Sigma)
y <- X %*% c(1, 2, 2, 3, 4, 0, 0, 0)
lassos=cv.glmnet(X, y, alpha=1, lambda = exp(seq(-4, 5, 0.3)))
ridges=cv.glmnet(X, y, alpha=0, lambda = exp(seq(-4, 5, 0.3)))
plot(lassos, ylab = "MSE", yaxt="n")
par(new=TRUE)
plot(ridges, ylab="", yaxt="n")
n <- 500
Sigma <- matrix(runif(64, 0, 0.5), nrow = 18, ncol = 18)
diag(Sigma) <- 1
Sigma[lower.tri(Sigma)] = t(Sigma)[lower.tri(Sigma)]
X <- mvrnorm(n = n, c(1:5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), Sigma)
n <- 500
Sigma <- matrix(runif(64, 0, 0.5), nrow = 18, ncol = 18)
diag(Sigma) <- 1
Sigma[lower.tri(Sigma)] = t(Sigma)[lower.tri(Sigma)]
X <- mvrnorm(n = n, c(1:5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), Sigma)
n <- 500
Sigma <- matrix(runif(64, 0, 0.5), nrow = 18, ncol = 18)
diag(Sigma) <- 1
Sigma[lower.tri(Sigma)] = t(Sigma)[lower.tri(Sigma)]
X <- mvrnorm(n = n, c(1:5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), Sigma)
n <- 500
Sigma <- matrix(runif(64, 0, 0.2), nrow = 18, ncol = 18)
diag(Sigma) <- 1
Sigma[lower.tri(Sigma)] = t(Sigma)[lower.tri(Sigma)]
X <- mvrnorm(n = n, c(1:5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), Sigma)
y <- X %*% c(1, 2, 2, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
lassos=cv.glmnet(X, y, alpha=1, lambda = exp(seq(-4, 5, 0.3)))
ridges=cv.glmnet(X, y, alpha=0, lambda = exp(seq(-4, 5, 0.3)))
plot(lassos, ylab = "MSE", yaxt="n")
par(new=TRUE)
plot(ridges, ylab="", yaxt="n")
n <- 500
Sigma <- matrix(runif(18*18, 0, 0.2), nrow = 18, ncol = 18)
diag(Sigma) <- 1
Sigma[lower.tri(Sigma)] = t(Sigma)[lower.tri(Sigma)]
X <- mvrnorm(n = n, c(1:5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), Sigma)
y <- X %*% c(1, 2, 2, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
lassos=cv.glmnet(X, y, alpha=1, lambda = exp(seq(-4, 5, 0.3)))
ridges=cv.glmnet(X, y, alpha=0, lambda = exp(seq(-4, 5, 0.3)))
plot(lassos, ylab = "MSE", yaxt="n")
par(new=TRUE)
plot(ridges, ylab="", yaxt="n")
n <- 500
Sigma <- matrix(runif(18*18, 0, 0.3), nrow = 18, ncol = 18)
diag(Sigma) <- 1
Sigma[lower.tri(Sigma)] = t(Sigma)[lower.tri(Sigma)]
X <- mvrnorm(n = n, c(1:5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), Sigma)
y <- X %*% c(1, 2, 2, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
lassos=cv.glmnet(X, y, alpha=1, lambda = exp(seq(-4, 5, 0.3)))
ridges=cv.glmnet(X, y, alpha=0, lambda = exp(seq(-4, 5, 0.3)))
plot(lassos, ylab = "MSE", yaxt="n")
par(new=TRUE)
plot(ridges, ylab="", yaxt="n")
n <- 500
Sigma <- matrix(runif(18*18, 0, 0.4), nrow = 18, ncol = 18)
diag(Sigma) <- 1
Sigma[lower.tri(Sigma)] = t(Sigma)[lower.tri(Sigma)]
X <- mvrnorm(n = n, c(1:5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), Sigma)
n <- 500
Sigma <- matrix(runif(18*18, 0, 0.3), nrow = 18, ncol = 18)
diag(Sigma) <- 1
Sigma[lower.tri(Sigma)] = t(Sigma)[lower.tri(Sigma)]
X <- mvrnorm(n = n, c(1:5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), Sigma)
y <- X %*% c(1, 2, 2, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
lassos=cv.glmnet(X, y, alpha=1, lambda = exp(seq(-4, 5, 0.3)))
ridges=cv.glmnet(X, y, alpha=0, lambda = exp(seq(-4, 5, 0.3)))
plot(lassos, ylab = "MSE", yaxt="n")
par(new=TRUE)
plot(ridges, ylab="", yaxt="n")
set.seed(139)
n <- 500
Sigma <- matrix(runif(18*18, 0, 0.3), nrow = 18, ncol = 18)
diag(Sigma) <- 1
Sigma[lower.tri(Sigma)] = t(Sigma)[lower.tri(Sigma)]
X <- mvrnorm(n = n, c(1:5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), Sigma)
y <- X %*% c(1, 2, 2, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
lassos=cv.glmnet(X, y, alpha=1, lambda = exp(seq(-4, 5, 0.3)))
ridges=cv.glmnet(X, y, alpha=0, lambda = exp(seq(-4, 5, 0.3)))
plot(lassos, ylab = "MSE", yaxt="n")
par(new=TRUE)
plot(ridges, ylab="", yaxt="n")
set.seed(139)
n <- 50
Sigma <- matrix(runif(18*18, 0, 0.3), nrow = 18, ncol = 18)
diag(Sigma) <- 1
Sigma[lower.tri(Sigma)] = t(Sigma)[lower.tri(Sigma)]
X <- mvrnorm(n = n, c(1:5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), Sigma)
y <- X %*% c(1, 2, 2, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
lassos=cv.glmnet(X, y, alpha=1, lambda = exp(seq(-4, 5, 0.3)))
ridges=cv.glmnet(X, y, alpha=0, lambda = exp(seq(-4, 5, 0.3)))
plot(lassos, ylab = "MSE", yaxt="n")
par(new=TRUE)
plot(ridges, ylab="", yaxt="n")
set.seed(139)
n <- 5
Sigma <- matrix(runif(18*18, 0, 0.3), nrow = 18, ncol = 18)
diag(Sigma) <- 1
Sigma[lower.tri(Sigma)] = t(Sigma)[lower.tri(Sigma)]
X <- mvrnorm(n = n, c(1:5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), Sigma)
y <- X %*% c(1, 2, 2, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
lassos=cv.glmnet(X, y, alpha=1, lambda = exp(seq(-4, 5, 0.3)))
ridges=cv.glmnet(X, y, alpha=0, lambda = exp(seq(-4, 5, 0.3)))
plot(lassos, ylab = "MSE", yaxt="n")
par(new=TRUE)
plot(ridges, ylab="", yaxt="n")
set.seed(139)
n <- 20
Sigma <- matrix(runif(18*18, 0, 0.3), nrow = 18, ncol = 18)
diag(Sigma) <- 1
Sigma[lower.tri(Sigma)] = t(Sigma)[lower.tri(Sigma)]
X <- mvrnorm(n = n, c(1:5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), Sigma)
y <- X %*% c(1, 2, 2, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
lassos=cv.glmnet(X, y, alpha=1, lambda = exp(seq(-4, 5, 0.3)))
ridges=cv.glmnet(X, y, alpha=0, lambda = exp(seq(-4, 5, 0.3)))
plot(lassos, ylab = "MSE", yaxt="n")
par(new=TRUE)
plot(ridges, ylab="", yaxt="n")
set.seed(139)
n <- 30
Sigma <- matrix(runif(18*18, 0, 0.3), nrow = 18, ncol = 18)
diag(Sigma) <- 1
Sigma[lower.tri(Sigma)] = t(Sigma)[lower.tri(Sigma)]
X <- mvrnorm(n = n, c(1:5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), Sigma)
y <- X %*% c(1, 2, 2, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
lassos=cv.glmnet(X, y, alpha=1, lambda = exp(seq(-4, 5, 0.3)))
ridges=cv.glmnet(X, y, alpha=0, lambda = exp(seq(-4, 5, 0.3)))
plot(lassos, ylab = "MSE", yaxt="n")
par(new=TRUE)
plot(ridges, ylab="", yaxt="n")
set.seed(139)
n <- 30
Sigma <- matrix(runif(18*18, 0, 0.3), nrow = 18, ncol = 18)
diag(Sigma) <- 1
Sigma[lower.tri(Sigma)] = t(Sigma)[lower.tri(Sigma)]
X <- mvrnorm(n = n, c(1:5, 1:13), Sigma)
y <- X %*% c(1, 2, 2, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
lassos=cv.glmnet(X, y, alpha=1, lambda = exp(seq(-4, 5, 0.3)))
ridges=cv.glmnet(X, y, alpha=0, lambda = exp(seq(-4, 5, 0.3)))
plot(lassos, ylab = "MSE", yaxt="n")
par(new=TRUE)
plot(ridges, ylab="", yaxt="n")
set.seed(139)
n <- 30
Sigma <- matrix(runif(18*18, 0, 0.3), nrow = 18, ncol = 18)
diag(Sigma) <- 1
Sigma[lower.tri(Sigma)] = t(Sigma)[lower.tri(Sigma)]
Sigma <- Sigma * 10
X <- mvrnorm(n = n, c(1:5, 1:13), Sigma)
y <- X %*% c(1, 2, 2, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
lassos=cv.glmnet(X, y, alpha=1, lambda = exp(seq(-4, 5, 0.3)))
ridges=cv.glmnet(X, y, alpha=0, lambda = exp(seq(-4, 5, 0.3)))
plot(lassos, ylab = "MSE", yaxt="n")
par(new=TRUE)
plot(ridges, ylab="", yaxt="n")
set.seed(139)
n <- 30
Sigma <- matrix(runif(18*18, 0, 0.3), nrow = 18, ncol = 18)
diag(Sigma) <- 1
Sigma[lower.tri(Sigma)] = t(Sigma)[lower.tri(Sigma)]
Sigma <- Sigma * 10
X <- mvrnorm(n = n, c(1:5, 1:13), Sigma)
y <- X %*% c(1, 2, 2, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
lassos=cv.glmnet(X, y, alpha=1, lambda = exp(seq(-4, 5, 0.3)))
ridges=cv.glmnet(X, y, alpha=0, lambda = exp(seq(-4, 5, 0.3)))
plot(lassos, ylab = "MSE", yaxt="n")
par(new=TRUE)
plot(ridges, ylab="", yaxt="n")
set.seed(139)
n <- 30
Sigma <- matrix(runif(18*18, 0, 0.3), nrow = 18, ncol = 18)
diag(Sigma) <- 1
Sigma[lower.tri(Sigma)] = t(Sigma)[lower.tri(Sigma)]
Sigma <- Sigma * 10
X <- mvrnorm(n = n, c(1:5, 1:13), Sigma)
y <- X %*% c(1, 2, 2, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
lassos=cv.glmnet(X, y, alpha=1, lambda = exp(seq(-4, 5, 0.3)))
ridges=cv.glmnet(X, y, alpha=0, lambda = exp(seq(-4, 5, 0.3)))
plot(lassos, ylab = "MSE", yaxt="n")
par(new=TRUE)
#plot(ridges, ylab="", yaxt="n")
set.seed(139)
n <- 30
Sigma <- matrix(runif(18*18, 0, 0.3), nrow = 18, ncol = 18)
diag(Sigma) <- 1
Sigma[lower.tri(Sigma)] = t(Sigma)[lower.tri(Sigma)]
Sigma <- Sigma * 10
X <- mvrnorm(n = n, c(1:5, 1:13), Sigma)
y <- X %*% c(1, 2, 2, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
lassos=cv.glmnet(X, y, alpha=1, lambda = exp(seq(-4, 5, 0.3)))
ridges=cv.glmnet(X, y, alpha=0, lambda = exp(seq(-4, 5, 0.3)))
plot(lassos, ylab = "MSE", yaxt="n")
par(new=TRUE)
plot(ridges, ylab="", yaxt="n")
plot(glmnet(X, y, alpha=0, lambda = exp(seq(-4, 5, 0.3))))
set.seed(139)
n <- 30
Sigma <- matrix(runif(18*18, 0, 0.3), nrow = 18, ncol = 18)
diag(Sigma) <- 1
Sigma[lower.tri(Sigma)] = t(Sigma)[lower.tri(Sigma)]
Sigma <- Sigma * 10
X <- mvrnorm(n = n, c(1:5, 1:13), Sigma)
y <- X %*% c(1, 2, 2, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
lassos=cv.glmnet(X, y, alpha=1, lambda = exp(seq(-4, 5, 0.3)))
ridges=cv.glmnet(X, y, alpha=0, lambda = exp(seq(-4, 5, 0.3)))
plot(lassos, ylab = "MSE", yaxt="n")
par(new=TRUE)
plot(ridges, ylab="", yaxt="n")
plot(glmnet(X, y, alpha=1, lambda = exp(seq(-4, 5, 0.3))))
set.seed(139)
n <- 50
Sigma <- matrix(runif(18*18, 0, 0.3), nrow = 18, ncol = 18)
diag(Sigma) <- 1
Sigma[lower.tri(Sigma)] = t(Sigma)[lower.tri(Sigma)]
Sigma <- Sigma * 10
X <- mvrnorm(n = n, c(1:5, 1:13), Sigma)
y <- X %*% c(1, 2, 2, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
lassos=cv.glmnet(X, y, alpha=1, lambda = exp(seq(-4, 5, 0.3)))
ridges=cv.glmnet(X, y, alpha=0, lambda = exp(seq(-4, 5, 0.3)))
plot(lassos, ylab = "MSE", yaxt="n")
par(new=TRUE)
plot(ridges, ylab="", yaxt="n")
plot(glmnet(X, y, alpha=1, lambda = exp(seq(-4, 5, 0.3))))
set.seed(139)
n <- 500
Sigma <- matrix(runif(18*18, 0, 0.3), nrow = 18, ncol = 18)
diag(Sigma) <- 1
Sigma[lower.tri(Sigma)] = t(Sigma)[lower.tri(Sigma)]
Sigma <- Sigma * 10
X <- mvrnorm(n = n, c(1:5, 1:13), Sigma)
y <- X %*% c(1, 2, 2, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
lassos=cv.glmnet(X, y, alpha=1, lambda = exp(seq(-4, 5, 0.3)))
ridges=cv.glmnet(X, y, alpha=0, lambda = exp(seq(-4, 5, 0.3)))
plot(lassos, ylab = "MSE", yaxt="n")
par(new=TRUE)
plot(ridges, ylab="", yaxt="n")
plot(glmnet(X, y, alpha=1, lambda = exp(seq(-4, 5, 0.3))))
set.seed(139)
n <- 500
Sigma <- matrix(0.3, nrow = 18, ncol = 18)
diag(Sigma) <- 1
Sigma[lower.tri(Sigma)] = t(Sigma)[lower.tri(Sigma)]
Sigma <- Sigma * 10
X <- mvrnorm(n = n, c(1:5, 1:13), Sigma)
y <- X %*% c(1, 2, 2, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
lassos=cv.glmnet(X, y, alpha=1, lambda = exp(seq(-4, 5, 0.3)))
ridges=cv.glmnet(X, y, alpha=0, lambda = exp(seq(-4, 5, 0.3)))
plot(lassos, ylab = "MSE", yaxt="n")
par(new=TRUE)
plot(ridges, ylab="", yaxt="n")
plot(glmnet(X, y, alpha=1, lambda = exp(seq(-4, 5, 0.3))))
plot(glmnet(X, y, alpha=0, lambda=exp(seq(-3,10,0.1))))
plot(glmnet(X, y, alpha=0, lambda=exp(seq(-3,15,0.1))))
set.seed(139)
n <- 500
Sigma <- matrix(0.3, nrow = 18, ncol = 18)
diag(Sigma) <- 1
Sigma[lower.tri(Sigma)] = t(Sigma)[lower.tri(Sigma)]
Sigma <- Sigma * 10
X <- mvrnorm(n = n, c(1:5, 1:13), Sigma)
y <- X %*% c(1, 2, 2, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
lassos=cv.glmnet(X, y, alpha=1, lambda = exp(seq(-4, 5, 0.3)))
ridges=cv.glmnet(X, y, alpha=0, lambda = exp(seq(-4, 5, 0.3)))
plot(lassos, ylab = "MSE", yaxt="n")
par(new=TRUE)
plot(ridges, ylab="", yaxt="n")
ridges_for_plot <- glmnet(X, y, alpha=0, lambda=exp(seq(-3,15,0.1)))
matplot(log(ridges_for_plot$lambda),
t(ridges_for_plot$beta) + matrix(c(rep(0, dim(ridges_for_plot$beta)[2] -
length(seq(-5,2,0.07))), dnorm(seq(-5,2,0.07))),
ncol = 8,
nrow = dim(ridges_for_plot$beta)[2]) * 1.5,
type="l", # Remove interactions
xlab = "log(lambda)",
ylab = "betas")
set.seed(139)
n <- 500
Sigma <- matrix(0.3, nrow = 18, ncol = 18)
diag(Sigma) <- 1
Sigma[lower.tri(Sigma)] = t(Sigma)[lower.tri(Sigma)]
Sigma <- Sigma * 10
X <- mvrnorm(n = n, c(1:5, 1:13), Sigma)
y <- X %*% c(1, 2, 2, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
lassos=cv.glmnet(X, y, alpha=1, lambda = exp(seq(-4, 5, 0.3)))
ridges=cv.glmnet(X, y, alpha=0, lambda = exp(seq(-4, 5, 0.3)))
plot(lassos, ylab = "MSE", yaxt="n")
par(new=TRUE)
plot(ridges, ylab="", yaxt="n")
ridges_for_plot <- glmnet(X, y, alpha=0, lambda=exp(seq(-3,15,0.1)))
matplot(log(ridges_for_plot$lambda),
t(ridges_for_plot$beta),
type="l", # Remove interactions
xlab = "log(lambda)",
ylab = "betas")
set.seed(139)
n <- 500
Sigma <- matrix(0.3, nrow = 18, ncol = 18)
diag(Sigma) <- 1
Sigma[lower.tri(Sigma)] = t(Sigma)[lower.tri(Sigma)]
Sigma <- Sigma * 10
X <- mvrnorm(n = n, c(1:5, 1:13), Sigma)
y <- X %*% c(1, 2, 2, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
lassos=cv.glmnet(X, y, alpha=1, lambda = exp(seq(-4, 5, 0.3)))
ridges=cv.glmnet(X, y, alpha=0, lambda = exp(seq(-4, 5, 0.3)))
plot(lassos, ylab = "MSE", yaxt="n")
par(new=TRUE)
plot(ridges, ylab="", yaxt="n")
ridges_for_plot <- glmnet(X, y, alpha=0, lambda=exp(seq(-4, 5, 0.3)))
matplot(log(ridges_for_plot$lambda),
t(ridges_for_plot$beta),
type="l", # Remove interactions
xlab = "log(lambda)",
ylab = "betas")
set.seed(139)
n <- 500
Sigma <- matrix(0.3, nrow = 18, ncol = 18)
diag(Sigma) <- 1
Sigma[lower.tri(Sigma)] = t(Sigma)[lower.tri(Sigma)]
Sigma <- Sigma * 10
X <- mvrnorm(n = n, c(1:5, 1:13), Sigma)
y <- X %*% c(1, 2, 2, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
lassos=cv.glmnet(X, y, alpha=1, lambda = exp(seq(-4, 5, 0.3)))
ridges=cv.glmnet(X, y, alpha=0, lambda = exp(seq(-4, 5, 0.3)))
plot(lassos, ylab = "MSE", yaxt="n")
par(new=TRUE)
plot(ridges, ylab="", yaxt="n")
ridges_for_plot <- glmnet(X, y, alpha=0, lambda=exp(seq(-4, 5, 0.3)))
matplot(log(ridges_for_plot$lambda),
t(ridges_for_plot$beta),
type="l", # Remove interactions
xlab = "log(lambda)",
ylab = "betas")
ridges_for_plot <- glmnet(X, y, alpha=1, lambda=exp(seq(-4, 5, 0.3)))
matplot(log(ridges_for_plot$lambda),
t(ridges_for_plot$beta),
type="l", # Remove interactions
xlab = "log(lambda)",
ylab = "betas")
set.seed(139)
n <- 500
Sigma <- matrix(0.3, nrow = 18, ncol = 18)
diag(Sigma) <- 1
Sigma[lower.tri(Sigma)] = t(Sigma)[lower.tri(Sigma)]
Sigma <- Sigma * 10
X <- mvrnorm(n = n, c(1:5, 1:13), Sigma)
y <- X %*% c(1, 2, 2, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
lassos=cv.glmnet(X, y, alpha=1, lambda = exp(seq(-4, 5, 0.3)))
ridges=cv.glmnet(X, y, alpha=0, lambda = exp(seq(-4, 5, 0.3)))
plot(lassos, ylab = "MSE", yaxt="n")
par(new=TRUE)
plot(ridges, ylab="", yaxt="n")
set.seed(139)
n <- 50
Sigma <- matrix(0.3, nrow = 18, ncol = 18)
diag(Sigma) <- 1
Sigma[lower.tri(Sigma)] = t(Sigma)[lower.tri(Sigma)]
Sigma <- Sigma * 10
X <- mvrnorm(n = n, c(1:5, 1:13), Sigma)
y <- X %*% c(1, 2, 2, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
lassos=cv.glmnet(X, y, alpha=1, lambda = exp(seq(-4, 5, 0.3)))
ridges=cv.glmnet(X, y, alpha=0, lambda = exp(seq(-4, 5, 0.3)))
#plot(lassos, ylab = "MSE", yaxt="n")
par(new=TRUE)
plot(ridges, ylab="", yaxt="n")
set.seed(139)
n <- 50
Sigma <- matrix(0.3, nrow = 18, ncol = 18)
diag(Sigma) <- 1
Sigma[lower.tri(Sigma)] = t(Sigma)[lower.tri(Sigma)]
Sigma <- Sigma * 10
X <- mvrnorm(n = n, c(1:5, 1:13), Sigma)
y <- X %*% c(1, 2, 2, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
lassos=cv.glmnet(X, y, alpha=1, lambda = exp(seq(-4, 5, 0.3)))
ridges=cv.glmnet(X, y, alpha=0, lambda = exp(seq(-4, 5, 0.3)))
plot(lassos, ylab = "MSE", yaxt="n")
par(new=TRUE)
plot(ridges, ylab="", yaxt="n")
?cv.glmnet
?cv.glmnet
countries <- read.csv("data/countries.csv")
# All coefficients of interest
lm1 <- lm(spi_ospi ~ (mad_gdppc + wdi_internet + wdi_birth + wdi_chexppgdp +
wdi_elerenew + wdi_lifexp + wdi_wip + wdi_popurb + wdi_imig)^2, countries)
summary(lm1)
library(glmnet)
set.seed(139)
# Variables to be used
columns <- c("mad_gdppc", "wdi_internet", "wdi_birth", "wdi_chexppgdp",
"wdi_elerenew", "wdi_lifexp", "wdi_wip", "wdi_popurb", "wdi_imig")
# Model matrix for glmnet
X = model.matrix(spi_ospi ~ (mad_gdppc + wdi_internet + wdi_birth + wdi_chexppgdp +
wdi_elerenew + wdi_lifexp + wdi_wip + wdi_popurb +
wdi_imig)^2, countries)[,-1] # Drop the intercept
# Scaling X is usually a good idea when penalizing betas
X <- scale(X)
# Run cross validation
ridges=cv.glmnet(X, unlist(lm1$model["spi_ospi"]), alpha=0)
print(ridges)
library(glmnet)
set.seed(139)
# Variables to be used
columns <- c("mad_gdppc", "wdi_internet", "wdi_birth", "wdi_chexppgdp",
"wdi_elerenew", "wdi_lifexp", "wdi_wip", "wdi_popurb", "wdi_imig")
# Model matrix for glmnet
X = model.matrix(spi_ospi ~ (mad_gdppc + wdi_internet + wdi_birth + wdi_chexppgdp +
wdi_elerenew + wdi_lifexp + wdi_wip + wdi_popurb +
wdi_imig)^2, countries)[,-1] # Drop the intercept
# Scaling X is usually a good idea when penalizing betas
X <- scale(X)
# Run cross validation
ridges=cv.glmnet(X, unlist(lm1$model["spi_ospi"]), alpha=0, lambda = exp(seq(-10,10,0.1)))
print(ridges)
plot(ridges)
# Fit for many lambdas
ridges_for_plot=glmnet(X, unlist(lm1$model["spi_ospi"]), alpha=0, lambda=exp(seq(-10,10,0.1)))
# Plot trajectories
matplot(log(ridges_for_plot$lambda),
t(ridges_for_plot$beta[-grep(":", rownames(ridges_for_plot$beta)),]), # Remove interactions
type="l",
xlab = "log(lambda)",
ylab = "betas")
# Run cross validation
lassos=cv.glmnet(X, unlist(lm1$model["spi_ospi"]), alpha=1, exp(seq(-10,10,0.1)))
# Run cross validation
lassos=cv.glmnet(X, unlist(lm1$model["spi_ospi"]), alpha=1, lambda = exp(seq(-10,10,0.1)))
print(lassos)
plot(lassos)
# Run cross validation
lassos=cv.glmnet(X, unlist(lm1$model["spi_ospi"]), alpha=1, lambda = exp(seq(-10,10,0.1)))
print(lassos)
plot(lassos)
lasso_for_plot = glmnet(X, unlist(lm1$model["spi_ospi"]), alpha=1, lambda=)
matplot(log(lasso_for_plot$lambda),
t(lasso_for_plot$beta[-grep(":", rownames(lasso_for_plot$beta)),]), # Remove interactions
type="l",
xlab = "log(lambda)",
ylab = "betas")
lasso_for_plot = glmnet(X, unlist(lm1$model["spi_ospi"]), alpha=1, lambda=exp(seq(-10,10,0.1)))
matplot(log(lasso_for_plot$lambda),
t(lasso_for_plot$beta[-grep(":", rownames(lasso_for_plot$beta)),]), # Remove interactions
type="l",
xlab = "log(lambda)",
ylab = "betas")
data.frame(ridge=min(ridges$cvm), lasso=min(lassos$cvm))
log(4.48)
log(0.100)
